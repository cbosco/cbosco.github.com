<!DOCTYPE html>
<html lang="en" ⚡>
<head>
    <meta charset="utf-8">
<link rel="canonical" href="/posts/Rails-Authenticate-with-EmberJS.html">
<meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">

<style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>

<script async custom-element="amp-carousel" src="https://cdn.ampproject.org/v0/amp-carousel-0.1.js"></script>
<script async custom-element="amp-analytics" src="https://cdn.ampproject.org/v0/amp-analytics-0.1.js"></script>
<script async src="https://cdn.ampproject.org/v0.js"></script>


<title>Rails: Authenticate with EmberJS</title>

<meta name="author" content="Chris Bosco">
<link rel="author" href="https://plus.google.com/107516626305634995395/posts"/>

  <meta name="keywords" content="chris bosco, chrisbosco, cbsides, cbosco, web, web app, designer, developer, portfolio, css, javascript, html, html5, user interface, ui, user experience, ux, experience design, interaction design">
  <meta name="copyright" content="copyright 2007-20014 chrisbosco.com">

<link href="https://fonts.googleapis.com/css?family=Oswald|Raleway" rel="stylesheet" type="text/css">
<style amp-custom>.button-bar:after,.row .row.collapse:after,.row .row:after,.row:after,[class*=block-grid-]:after,[data-clearing]:after{clear:both}.breadcrumbs,.button,button{border-style:solid;border-width:0}.button,.visible-img,body,button{position:relative}.icon-bar>* i,.social-icon i,img{vertical-align:middle}.side-nav,ul{list-style-position:outside}.button,.label,.side-nav li,body,button,label{font-weight:400}.breadcrumbs,.top-bar ul,[data-clearing]{list-style:none}.button,.label,.side-nav,.top-bar-section ul li>a,body,button{font-family:Raleway,"Helvetica Neue",Helvetica,Helvetica,Arial,sans-serif}.featured-heading h1 span,.featured-heading h2 span,.heading h1 span,.heading h2 span,.label{white-space:nowrap}body,html{height:100%;font-size:100%}*,:after,:before{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}body{background:#fff;color:#333;cursor:auto;font-style:normal;line-height:1.5;margin:0;padding:0}a:hover{cursor:pointer}.right{float:right}.hide{display:none}.row .row.collapse:after,.row .row.collapse:before,.row .row:after,.row .row:before,.row:after,.row:before,[class*=block-grid-]:after,[class*=block-grid-]:before{content:" ";display:table}img{max-width:100%;height:auto;-ms-interpolation-mode:bicubic;display:inline-block}.row{margin:0 auto;max-width:50rem;width:100%}.row.collapse>.columns{padding-left:0;padding-right:0}.row.collapse .row{margin-left:0;margin-right:0}.row .row{margin:0 -.9375rem;max-width:none;width:auto}.row .row.collapse{margin:0;max-width:none;width:auto}.columns{padding-left:.9375rem;padding-right:.9375rem;width:100%;float:left}.columns+.columns:last-child{float:right}.columns+.columns.end{float:left}@media only screen{.columns{position:relative;padding-left:.9375rem;padding-right:.9375rem;float:left}.small-1{width:8.33333%}.small-2{width:16.66667%}.small-3{width:25%}.small-4{width:33.33333%}.small-5{width:41.66667%}.small-6{width:50%}.small-7{width:58.33333%}.small-8{width:66.66667%}.small-9{width:75%}.small-10{width:83.33333%}.small-11{width:91.66667%}.small-12{width:100%}.small-offset-0{margin-left:0}.small-offset-1{margin-left:8.33333%}.small-offset-2{margin-left:16.66667%}.small-offset-3{margin-left:25%}.small-offset-4{margin-left:33.33333%}.small-offset-5{margin-left:41.66667%}.small-offset-6{margin-left:50%}.small-offset-7{margin-left:58.33333%}.small-offset-8{margin-left:66.66667%}.small-offset-9{margin-left:75%}.small-offset-10{margin-left:83.33333%}.small-offset-11{margin-left:91.66667%}.row.small-collapse>.columns{padding-left:0;padding-right:0}.row.small-collapse .row{margin-left:0;margin-right:0}}@media only screen and (min-width:40.0625em){.columns{position:relative;padding-left:.9375rem;padding-right:.9375rem;float:left}.medium-1{width:8.33333%}.medium-2{width:16.66667%}.medium-3{width:25%}.medium-4{width:33.33333%}.medium-5{width:41.66667%}.medium-6{width:50%}.medium-7{width:58.33333%}.medium-8{width:66.66667%}.medium-9{width:75%}.medium-10{width:83.33333%}.medium-11{width:91.66667%}.medium-12{width:100%}.medium-offset-0{margin-left:0}.medium-offset-1{margin-left:8.33333%}.medium-offset-2{margin-left:16.66667%}.medium-offset-3{margin-left:25%}.medium-offset-4{margin-left:33.33333%}.medium-offset-5{margin-left:41.66667%}.medium-offset-6{margin-left:50%}.medium-offset-7{margin-left:58.33333%}.medium-offset-8{margin-left:66.66667%}.medium-offset-9{margin-left:75%}.medium-offset-10{margin-left:83.33333%}.medium-offset-11{margin-left:91.66667%}.row.medium-collapse>.columns{padding-left:0;padding-right:0}.row.medium-collapse .row{margin-left:0;margin-right:0}}@media only screen and (min-width:64.0625em){.columns{position:relative;padding-left:.9375rem;padding-right:.9375rem;float:left}.large-1{width:8.33333%}.large-2{width:16.66667%}.large-3{width:25%}.large-4{width:33.33333%}.large-5{width:41.66667%}.large-6{width:50%}.large-7{width:58.33333%}.large-8{width:66.66667%}.large-9{width:75%}.large-10{width:83.33333%}.large-11{width:91.66667%}.large-12{width:100%}.large-offset-0{margin-left:0}.large-offset-1{margin-left:8.33333%}.large-offset-2{margin-left:16.66667%}.large-offset-3{margin-left:25%}.large-offset-4{margin-left:33.33333%}.large-offset-5{margin-left:41.66667%}.large-offset-6{margin-left:50%}.large-offset-7{margin-left:58.33333%}.large-offset-8{margin-left:66.66667%}.large-offset-9{margin-left:75%}.large-offset-10{margin-left:83.33333%}.large-offset-11{margin-left:91.66667%}.row.large-collapse>.columns{padding-left:0;padding-right:0}.row.large-collapse .row{margin-left:0;margin-right:0}}[class*=block-grid-]{display:block;padding:0;margin:0 -.625rem}[class*=block-grid-]>li{display:block;float:left;height:auto;padding:0 .625rem 1.25rem}@media only screen{.small-block-grid-1>li{list-style:none;width:100%}.small-block-grid-1>li:nth-of-type(1n){clear:none}.small-block-grid-1>li:nth-of-type(1n+1){clear:both}.small-block-grid-2>li{list-style:none;width:50%}.small-block-grid-2>li:nth-of-type(1n){clear:none}.small-block-grid-2>li:nth-of-type(2n+1){clear:both}.small-block-grid-3>li{list-style:none;width:33.33333%}.small-block-grid-3>li:nth-of-type(1n){clear:none}.small-block-grid-3>li:nth-of-type(3n+1){clear:both}.small-block-grid-4>li{list-style:none;width:25%}.small-block-grid-4>li:nth-of-type(1n){clear:none}.small-block-grid-4>li:nth-of-type(4n+1){clear:both}.small-block-grid-5>li{list-style:none;width:20%}.small-block-grid-5>li:nth-of-type(1n){clear:none}.small-block-grid-5>li:nth-of-type(5n+1){clear:both}.small-block-grid-6>li{list-style:none;width:16.66667%}.small-block-grid-6>li:nth-of-type(1n){clear:none}.small-block-grid-6>li:nth-of-type(6n+1){clear:both}.small-block-grid-7>li{list-style:none;width:14.28571%}.small-block-grid-7>li:nth-of-type(1n){clear:none}.small-block-grid-7>li:nth-of-type(7n+1){clear:both}.small-block-grid-8>li{list-style:none;width:12.5%}.small-block-grid-8>li:nth-of-type(1n){clear:none}.small-block-grid-8>li:nth-of-type(8n+1){clear:both}.small-block-grid-9>li{list-style:none;width:11.11111%}.small-block-grid-9>li:nth-of-type(1n){clear:none}.small-block-grid-9>li:nth-of-type(9n+1){clear:both}.small-block-grid-10>li{list-style:none;width:10%}.small-block-grid-10>li:nth-of-type(1n){clear:none}.small-block-grid-10>li:nth-of-type(10n+1){clear:both}.small-block-grid-11>li{list-style:none;width:9.09091%}.small-block-grid-11>li:nth-of-type(1n){clear:none}.small-block-grid-11>li:nth-of-type(11n+1){clear:both}.small-block-grid-12>li{list-style:none;width:8.33333%}.small-block-grid-12>li:nth-of-type(1n){clear:none}.small-block-grid-12>li:nth-of-type(12n+1){clear:both}}@media only screen and (min-width:40.0625em){.medium-block-grid-1>li{list-style:none;width:100%}.medium-block-grid-1>li:nth-of-type(1n){clear:none}.medium-block-grid-1>li:nth-of-type(1n+1){clear:both}.medium-block-grid-2>li{list-style:none;width:50%}.medium-block-grid-2>li:nth-of-type(1n){clear:none}.medium-block-grid-2>li:nth-of-type(2n+1){clear:both}.medium-block-grid-3>li{list-style:none;width:33.33333%}.medium-block-grid-3>li:nth-of-type(1n){clear:none}.medium-block-grid-3>li:nth-of-type(3n+1){clear:both}.medium-block-grid-4>li{list-style:none;width:25%}.medium-block-grid-4>li:nth-of-type(1n){clear:none}.medium-block-grid-4>li:nth-of-type(4n+1){clear:both}.medium-block-grid-5>li{list-style:none;width:20%}.medium-block-grid-5>li:nth-of-type(1n){clear:none}.medium-block-grid-5>li:nth-of-type(5n+1){clear:both}.medium-block-grid-6>li{list-style:none;width:16.66667%}.medium-block-grid-6>li:nth-of-type(1n){clear:none}.medium-block-grid-6>li:nth-of-type(6n+1){clear:both}.medium-block-grid-7>li{list-style:none;width:14.28571%}.medium-block-grid-7>li:nth-of-type(1n){clear:none}.medium-block-grid-7>li:nth-of-type(7n+1){clear:both}.medium-block-grid-8>li{list-style:none;width:12.5%}.medium-block-grid-8>li:nth-of-type(1n){clear:none}.medium-block-grid-8>li:nth-of-type(8n+1){clear:both}.medium-block-grid-9>li{list-style:none;width:11.11111%}.medium-block-grid-9>li:nth-of-type(1n){clear:none}.medium-block-grid-9>li:nth-of-type(9n+1){clear:both}.medium-block-grid-10>li{list-style:none;width:10%}.medium-block-grid-10>li:nth-of-type(1n){clear:none}.medium-block-grid-10>li:nth-of-type(10n+1){clear:both}.medium-block-grid-11>li{list-style:none;width:9.09091%}.medium-block-grid-11>li:nth-of-type(1n){clear:none}.medium-block-grid-11>li:nth-of-type(11n+1){clear:both}.medium-block-grid-12>li{list-style:none;width:8.33333%}.medium-block-grid-12>li:nth-of-type(1n){clear:none}.medium-block-grid-12>li:nth-of-type(12n+1){clear:both}}@media only screen and (min-width:64.0625em){.large-block-grid-1>li{list-style:none;width:100%}.large-block-grid-1>li:nth-of-type(1n){clear:none}.large-block-grid-1>li:nth-of-type(1n+1){clear:both}.large-block-grid-2>li{list-style:none;width:50%}.large-block-grid-2>li:nth-of-type(1n){clear:none}.large-block-grid-2>li:nth-of-type(2n+1){clear:both}.large-block-grid-3>li{list-style:none;width:33.33333%}.large-block-grid-3>li:nth-of-type(1n){clear:none}.large-block-grid-3>li:nth-of-type(3n+1){clear:both}.large-block-grid-4>li{list-style:none;width:25%}.large-block-grid-4>li:nth-of-type(1n){clear:none}.large-block-grid-4>li:nth-of-type(4n+1){clear:both}.large-block-grid-5>li{list-style:none;width:20%}.large-block-grid-5>li:nth-of-type(1n){clear:none}.large-block-grid-5>li:nth-of-type(5n+1){clear:both}.large-block-grid-6>li{list-style:none;width:16.66667%}.large-block-grid-6>li:nth-of-type(1n){clear:none}.large-block-grid-6>li:nth-of-type(6n+1){clear:both}.large-block-grid-7>li{list-style:none;width:14.28571%}.large-block-grid-7>li:nth-of-type(1n){clear:none}.large-block-grid-7>li:nth-of-type(7n+1){clear:both}.large-block-grid-8>li{list-style:none;width:12.5%}.large-block-grid-8>li:nth-of-type(1n){clear:none}.large-block-grid-8>li:nth-of-type(8n+1){clear:both}.large-block-grid-9>li{list-style:none;width:11.11111%}.large-block-grid-9>li:nth-of-type(1n){clear:none}.large-block-grid-9>li:nth-of-type(9n+1){clear:both}.large-block-grid-10>li{list-style:none;width:10%}.large-block-grid-10>li:nth-of-type(1n){clear:none}.large-block-grid-10>li:nth-of-type(10n+1){clear:both}.large-block-grid-11>li{list-style:none;width:9.09091%}.large-block-grid-11>li:nth-of-type(1n){clear:none}.large-block-grid-11>li:nth-of-type(11n+1){clear:both}.large-block-grid-12>li{list-style:none;width:8.33333%}.large-block-grid-12>li:nth-of-type(1n){clear:none}.large-block-grid-12>li:nth-of-type(12n+1){clear:both}}.breadcrumbs{display:block;margin-left:0;overflow:hidden;padding:.5rem 0;background-color:#fff;border-color:#e6e6e6;border-radius:3px}.breadcrumbs>*{color:#3DA3FC;float:left;font-size:.6875rem;line-height:.6875rem;margin:0;text-transform:uppercase}.breadcrumbs>:focus a,.breadcrumbs>:hover a{text-decoration:underline}.breadcrumbs>.current:focus,.breadcrumbs>.current:focus a,.breadcrumbs>.current:hover,.breadcrumbs>.current:hover a,.button,.label,a,button{text-decoration:none}.breadcrumbs>* a{color:#3DA3FC}.breadcrumbs>.current,.breadcrumbs>.current a{color:#333;cursor:default}.breadcrumbs>.unavailable,.breadcrumbs>.unavailable a{color:#999}.breadcrumbs>.unavailable a:focus,.breadcrumbs>.unavailable:focus,.breadcrumbs>.unavailable:hover,.breadcrumbs>.unavailable:hover a{color:#999;cursor:not-allowed;text-decoration:none}.breadcrumbs>:before{color:#AAA;content:"/";margin:0 .75rem;position:relative;top:1px}.breadcrumbs>:first-child:before{content:" ";margin:0}[aria-label=breadcrumbs] [aria-hidden=true]:after{content:"/"}.button,button{-webkit-appearance:none;-moz-appearance:none;border-radius:0;cursor:pointer;line-height:normal;margin:0 0 1.25rem;text-align:center;display:inline-block;padding:1rem 2rem 1.0625rem;font-size:1rem;background-color:#3DA3FC;border-color:#0485f7;color:#FFF;transition:background-color .3s ease-out}.button:focus,.button:hover,button:focus,button:hover{background-color:#0485f7;color:#FFF}.button[disabled],.button[disabled]:focus,.button[disabled]:hover,button[disabled],button[disabled]:focus,button[disabled]:hover{color:#FFF;background-color:#3DA3FC}.button.large,button.large{padding:1.125rem 2.25rem 1.1875rem;font-size:1.25rem}.button.small,button.small{padding:.875rem 1.75rem .9375rem;font-size:.8125rem}.button.expand,button.expand{padding:1rem 1rem 1.0625rem;font-size:1rem;width:100%}.button[disabled],button[disabled]{border-color:#0485f7;box-shadow:none;cursor:default;opacity:.7}button::-moz-focus-inner{border:0;padding:0}@media only screen and (min-width:40.0625em){.button,button{display:inline-block}}.button-bar:after,.button-bar:before,[data-clearing]:after,[data-clearing]:before{content:" ";display:table}[data-clearing]{margin-left:0;margin-bottom:0}[data-clearing] li{float:left;margin-right:10px}[data-clearing][class*=block-grid-] li{margin-right:0}.visible-img{height:95%}.visible-img img{position:absolute;left:50%;top:50%;-webkit-transform:translateY(-50%) translateX(-50%);-moz-transform:translateY(-50%) translateX(-50%);-ms-transform:translateY(-50%) translateX(-50%);-o-transform:translateY(-50%) translateX(-50%);transform:translateY(-50%) translateX(-50%);max-height:100%;max-width:100%}.label,.top-bar,.top-bar-section{position:relative}label{color:#4d4d4d;cursor:pointer;display:block;font-size:.875rem;line-height:1.5;margin-bottom:0}label.right{float:none;text-align:right}label small{text-transform:capitalize;color:#676767}::-webkit-input-placeholder{color:#666}:-moz-placeholder{color:#666}::-moz-placeholder{color:#666}:-ms-input-placeholder{color:#666}.icon-bar>* i,.icon-bar>* label,.icon-bar>a:hover i,.icon-bar>a:hover label,.label{color:#FFF}.icon-bar{display:inline-block;font-size:0;width:100%;background:#333}.icon-bar>*,.icon-bar>* i,.icon-bar>* img{display:block;margin:0 auto}.icon-bar>*{float:left;text-align:center;width:25%;font-size:1rem;padding:1.25rem}.icon-bar.label-right>* label,.label{display:inline-block}.icon-bar>* i+label,.icon-bar>* img+label{margin-top:.0625rem;font-size:1rem}.icon-bar>* i{font-size:1.875rem}.icon-bar.label-right>* i,.icon-bar.label-right>* img{display:inline-block;margin:0 .0625rem 0 0}.icon-bar.label-right>* i+label,.icon-bar.label-right>* img+label{margin-top:0}.icon-bar>* img{height:1.875rem;width:1.875rem}.icon-bar>a:hover{background:#3DA3FC}.label{line-height:1;margin-bottom:auto;text-align:center;padding:.25rem .5rem;font-size:.6875rem;background-color:#3DA3FC}[data-magellan-expedition-clone],[data-magellan-expedition]{background:#FFF;min-width:100%;padding:10px;z-index:50}@-webkit-keyframes rotate{from{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes rotate{from{-webkit-transform:rotate(0);-moz-transform:rotate(0);-ms-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(360deg);-moz-transform:rotate(360deg);-ms-transform:rotate(360deg);transform:rotate(360deg)}}.side-nav{display:block;list-style-type:none;margin:0;padding:.875rem 0}.side-nav li{font-size:.875rem;margin:0 0 .4375rem}.contain-to-grid .top-bar,.top-bar,.top-bar ul{margin-bottom:0}.side-nav li a:not(.button){color:#3DA3FC;display:block;margin:0;padding:.4375rem .875rem}.side-nav li a:not(.button):focus,.side-nav li a:not(.button):hover{background:rgba(0,0,0,.025);color:#77bffd}.side-nav li a:not(.button):active{color:#77bffd}.side-nav li.heading{color:#3DA3FC;font-size:.875rem;font-weight:700;text-transform:uppercase}.contain-to-grid{width:100%;background:#f96}.top-bar{background:#f96;height:5.3125rem;line-height:5.3125rem;overflow:hidden}.top-bar .row{max-width:none}.top-bar .button,.top-bar button{font-size:.75rem;margin-bottom:0;padding-bottom:.4125rem;padding-top:.4125rem}@media only screen and (max-width:40em){.top-bar .button,.top-bar button{position:relative;top:-1px}}.top-bar .title-area{margin:0;position:relative;float:left}.top-bar .name{font-size:16px;margin:0}.top-bar .name h1,.top-bar .name h2,.top-bar .name h3,.top-bar .name h4,.top-bar .name p,.top-bar .name span{font-size:1.0625rem;line-height:5.3125rem;margin:0}.top-bar .name h1 a,.top-bar .name h2 a,.top-bar .name h3 a,.top-bar .name h4 a,.top-bar .name p a,.top-bar .name span a{color:#FFF;display:block;font-weight:400;padding:0 1.77083rem;width:75%}.top-bar-section{left:0;width:auto;transition:left .3s ease-out}.top-bar-section ul{display:block;font-size:16px;height:auto;margin:0;padding:0;width:100%}.top-bar-section [role=separator]{border-top:solid 1px #b33c00;clear:both;height:1px;width:100%}.top-bar-section ul li{background:#333}.top-bar-section ul li>a{color:#FFF;display:block;font-size:.8125rem;font-weight:400;padding:12px 0 12px 1.77083rem;text-transform:none;width:100%}.top-bar-section ul li>a.button,.top-bar-section ul li>button{font-size:.8125rem;padding-left:1.77083rem;padding-right:1.77083rem;border-color:#0485f7;color:#FFF}.top-bar-section ul li>a.button{background-color:#3DA3FC}.top-bar-section ul li>a.button:focus,.top-bar-section ul li>a.button:hover{background-color:#0485f7;color:#FFF}.top-bar-section ul li>button{background-color:#3DA3FC}.top-bar-section ul li>button:focus,.top-bar-section ul li>button:hover{background-color:#0485f7;color:#FFF}.top-bar-section ul li:hover:not(.has-form)>a{color:#FFF;background:#222}@media only screen and (min-width:40.0625em){.top-bar .title-area,.top-bar-section ul li{float:left}.top-bar{background:#f96;overflow:visible}.top-bar:after,.top-bar:before{content:" ";display:table}.top-bar:after{clear:both}.top-bar .name h1 a,.top-bar .name h2 a,.top-bar .name h3 a,.top-bar .name h4 a,.top-bar .name h5 a,.top-bar .name h6 a{width:auto}.top-bar .button,.top-bar button{font-size:.875rem;height:1.75rem;position:relative;top:1.78125rem}.contain-to-grid .top-bar{margin:0 auto;max-width:50rem}.top-bar-section{transition:none 0 0;left:0}.top-bar-section ul{display:inline;height:auto;width:auto}.top-bar-section li:not(.has-form) a:not(.button){background:#f96;line-height:5.3125rem;padding:0 1.77083rem}.top-bar-section li:not(.has-form) a:not(.button):hover{background:#222}.top-bar-section>ul>[role=separator]{border-right:solid 1px #ffa67a;border-bottom:none;border-top:none;clear:none;height:5.3125rem;width:0}.no-js .top-bar-section ul li:hover>a{background:#222;color:#FFF}.no-js .top-bar-section ul li:active>a{background:#3DA3FC;color:#FFF}}a,b,i,small{line-height:inherit}.text-right{text-align:right}.text-center{text-align:center}@media only screen and (max-width:40em){.small-only-text-right{text-align:right}.small-only-text-center{text-align:center}}@media only screen{.small-text-right{text-align:right}.small-text-center{text-align:center}}@media only screen and (min-width:40.0625em) and (max-width:64em){.medium-only-text-right{text-align:right}.medium-only-text-center{text-align:center}}@media only screen and (min-width:40.0625em){.medium-text-right{text-align:right}.medium-text-center{text-align:center}}@media only screen and (min-width:64.0625em) and (max-width:90em){.large-only-text-right{text-align:right}.large-only-text-center{text-align:center}}div,h1,h2,h3,h4,h5,h6,li,p,ul{margin:0;padding:0}p,ul{line-height:1.6;margin-bottom:1.25rem}a{color:#3DA3FC}a:focus,a:hover{color:#128ffb}a img{border:none}p{font-family:inherit;font-size:1rem;font-weight:400;text-rendering:optimizeLegibility}h1,h2,h3,h4,h5,h6{color:#555;font-family:Oswald,Impact,sans-serif;font-style:normal;font-weight:400;line-height:1.4;margin-bottom:.5rem;margin-top:.2rem;text-rendering:optimizeLegibility;text-transform:uppercase}h1 small,h2 small,h3 small,h4 small,h5 small,h6 small{color:#919191;font-size:60%;line-height:0}h1{font-size:1.5625rem}h2{font-size:1.25rem}h3,h4{font-size:1.4375rem}h5{font-size:1.75rem}h6{font-size:1rem}i{font-style:italic}b{font-weight:700}.fa,code{font-weight:400}small{font-size:60%}code{background-color:#f8f8f8;border-color:#dfdfdf;border-style:solid;border-width:1px;font-family:Consolas,Liberation Mono,Courier,monospace;padding:.125rem .3125rem .0625rem}ul{font-family:inherit;font-size:1rem;margin-left:1.1rem}ul li ul{margin-left:1.25rem;margin-bottom:0}ul.square li ul{list-style:inherit}ul.square{list-style-type:square;margin-left:1.1rem}.fa-ul,.no-bullet{list-style-type:none}.no-bullet{margin-left:0}.no-bullet li ul{margin-left:1.25rem;margin-bottom:0;list-style:none}@media print{*{background:0 0;color:#000;box-shadow:none;text-shadow:none}a,a:visited{text-decoration:underline}a[href]:after{content:" (" attr(href) ")"}a[href^="javascript:"]:after,a[href^="#"]:after{content:""}img{page-break-inside:avoid;max-width:100%}h2,h3,p{orphans:3;widows:3}h2,h3{page-break-after:avoid}}.right-small{height:2.8125rem;position:absolute;top:0;width:2.8125rem;border-left:solid 1px #1a1a1a;right:0}@media only screen{.hide-for-large,.hide-for-large-only,.hide-for-large-up,.hide-for-medium,.hide-for-medium-only,.hide-for-medium-up,.show-for-small,.show-for-small-only,.show-for-small-up{display:inherit}.hide-for-small,.hide-for-small-only,.hide-for-small-up,.show-for-large,.show-for-large-only,.show-for-large-up,.show-for-medium,.show-for-medium-only,.show-for-medium-up{display:none}.hidden-for-large,.hidden-for-large-only,.hidden-for-large-up,.hidden-for-medium,.hidden-for-medium-only,.hidden-for-medium-up,.visible-for-small,.visible-for-small-only,.visible-for-small-up{position:static;height:auto;width:auto;overflow:visible;clip:auto}.hidden-for-small,.hidden-for-small-only,.hidden-for-small-up,.visible-for-large,.visible-for-large-only,.visible-for-large-up,.visible-for-medium,.visible-for-medium-only,.visible-for-medium-up{clip:rect(1px,1px,1px,1px);height:1px;overflow:hidden;position:absolute;width:1px}}@media only screen and (min-width:40.0625em){h1,h2,h3,h4,h5,h6{line-height:1.4}h1{font-size:2.1875rem}h2{font-size:1.875rem}h3,h4,h5{font-size:1.75rem}h6{font-size:1rem}.hide-for-large,.hide-for-large-only,.hide-for-large-up,.hide-for-small,.hide-for-small-only,.show-for-medium,.show-for-medium-only,.show-for-medium-up,.show-for-small-up{display:inherit}.hide-for-medium,.hide-for-medium-only,.hide-for-medium-up,.hide-for-small-up,.show-for-large,.show-for-large-only,.show-for-large-up,.show-for-small,.show-for-small-only{display:none}.hidden-for-large,.hidden-for-large-only,.hidden-for-large-up,.hidden-for-small,.hidden-for-small-only,.visible-for-medium,.visible-for-medium-only,.visible-for-medium-up,.visible-for-small-up{position:static;height:auto;width:auto;overflow:visible;clip:auto}.hidden-for-medium,.hidden-for-medium-only,.hidden-for-medium-up,.hidden-for-small-up,.visible-for-large,.visible-for-large-only,.visible-for-large-up,.visible-for-small,.visible-for-small-only{clip:rect(1px,1px,1px,1px);height:1px;overflow:hidden;position:absolute;width:1px}}@media only screen and (min-width:64.0625em){.large-text-right{text-align:right}.large-text-center{text-align:center}.hide-for-medium,.hide-for-medium-only,.hide-for-small,.hide-for-small-only,.show-for-large,.show-for-large-only,.show-for-large-up,.show-for-medium-up,.show-for-small-up{display:inherit}.hide-for-large,.hide-for-large-only,.hide-for-large-up,.hide-for-medium-up,.hide-for-small-up,.show-for-medium,.show-for-medium-only,.show-for-small,.show-for-small-only{display:none}.hidden-for-medium,.hidden-for-medium-only,.hidden-for-small,.hidden-for-small-only,.visible-for-large,.visible-for-large-only,.visible-for-large-up,.visible-for-medium-up,.visible-for-small-up{position:static;height:auto;width:auto;overflow:visible;clip:auto}.hidden-for-large,.hidden-for-large-only,.hidden-for-large-up,.hidden-for-medium-up,.hidden-for-small-up,.visible-for-medium,.visible-for-medium-only,.visible-for-small,.visible-for-small-only{clip:rect(1px,1px,1px,1px);height:1px;overflow:hidden;position:absolute;width:1px}}@media only screen and (min-width:90.0625em){.hide-for-large,.hide-for-large-only,.hide-for-medium,.hide-for-medium-only,.hide-for-small,.hide-for-small-only,.show-for-large-up,.show-for-medium-up,.show-for-small-up{display:inherit}.hide-for-large-up,.hide-for-medium-up,.hide-for-small-up,.show-for-large,.show-for-large-only,.show-for-medium,.show-for-medium-only,.show-for-small,.show-for-small-only{display:none}.hidden-for-large,.hidden-for-large-only,.hidden-for-medium,.hidden-for-medium-only,.hidden-for-small,.hidden-for-small-only,.visible-for-large-up,.visible-for-medium-up,.visible-for-small-up{position:static;height:auto;width:auto;overflow:visible;clip:auto}.hidden-for-large-up,.hidden-for-medium-up,.hidden-for-small-up,.visible-for-large,.visible-for-large-only,.visible-for-medium,.visible-for-medium-only,.visible-for-small,.visible-for-small-only{clip:rect(1px,1px,1px,1px);height:1px;overflow:hidden;position:absolute;width:1px}}@media only screen and (min-width:120.0625em){.hide-for-large,.hide-for-large-only,.hide-for-medium,.hide-for-medium-only,.hide-for-small,.hide-for-small-only,.show-for-large-up,.show-for-medium-up,.show-for-small-up{display:inherit}.hide-for-large-up,.hide-for-medium-up,.hide-for-small-up,.show-for-large,.show-for-large-only,.show-for-medium,.show-for-medium-only,.show-for-small,.show-for-small-only{display:none}.hidden-for-large,.hidden-for-large-only,.hidden-for-medium,.hidden-for-medium-only,.hidden-for-small,.hidden-for-small-only,.visible-for-large-up,.visible-for-medium-up,.visible-for-small-up{position:static;height:auto;width:auto;overflow:visible;clip:auto}.hidden-for-large-up,.hidden-for-medium-up,.hidden-for-small-up,.visible-for-large,.visible-for-large-only,.visible-for-medium,.visible-for-medium-only,.visible-for-small,.visible-for-small-only{clip:rect(1px,1px,1px,1px);height:1px;overflow:hidden;position:absolute;width:1px}}/*!
 *  Font Awesome 4.1.0 by @davegandy - http://fontawesome.io - @fontawesome
 *  License - http://fontawesome.io/license (Font: SIL OFL 1.1, CSS: MIT License)
 */@font-face{font-family:FontAwesome;src:url(/assets/fontawesome-webfont.eot?v=4.1.0);src:url(/assets/fontawesome-webfont.eot?#iefix&v=4.1.0) format("embedded-opentype"),url(/assets/fontawesome-webfont.woff?v=4.1.0) format("woff"),url(/assets/fontawesome-webfont.ttf?v=4.1.0) format("truetype"),url(/assets/fontawesome-webfont.svg?v=4.1.0#fontawesomeregular) format("svg");font-weight:400;font-style:normal}.fa{display:inline-block;font-family:FontAwesome;font-style:normal;line-height:1;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.fa-ul{padding-left:0;margin-left:2.14286em}.fa-ul>li{position:relative}.fa-li{position:absolute;left:-2.14286em;width:2.14286em;top:.14286em;text-align:center}@-moz-keyframes spin{0%{-moz-transform:rotate(0)}100%{-moz-transform:rotate(359deg)}}@-webkit-keyframes spin{0%{-webkit-transform:rotate(0)}100%{-webkit-transform:rotate(359deg)}}@-o-keyframes spin{0%{-o-transform:rotate(0)}100%{-o-transform:rotate(359deg)}}@keyframes spin{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(359deg);transform:rotate(359deg)}}.fa-inverse{color:#fff}.fa-envelope-o:before{content:""}.fa-user:before{content:""}.fa-tag:before{content:""}.fa-tags:before{content:""}.fa-text-height:before{content:""}.fa-text-width:before{content:""}.fa-list:before{content:""}.fa-image:before,.fa-photo:before{content:""}.fa-pencil:before{content:""}.fa-pencil-square-o:before{content:""}.fa-expand:before{content:""}.fa-plus:before{content:""}.fa-folder:before{content:""}.fa-twitter-square:before{content:""}.fa-linkedin-square:before{content:""}.fa-external-link:before{content:""}.fa-github-square:before{content:""}.fa-square-o:before{content:""}.fa-twitter:before{content:""}.fa-github:before{content:""}.fa-bullhorn:before{content:""}.fa-filter:before{content:""}.fa-link:before{content:""}.fa-copy:before{content:""}.fa-square:before{content:""}.fa-list-ul:before{content:""}.fa-google-plus-square:before{content:""}.fa-google-plus:before{content:""}.fa-columns:before{content:""}.fa-sort:before{content:""}.fa-sort-up:before{content:""}.fa-envelope:before{content:""}.fa-linkedin:before{content:""}.fa-user-md:before{content:""}.fa-h-square:before{content:""}.fa-plus-square:before{content:""}.fa-angle-right:before{content:""}.fa-angle-up:before{content:""}.fa-folder-o:before{content:""}.fa-code:before{content:""}.fa-html5:before{content:""}.fa-css3:before{content:""}.fa-ellipsis-h:before{content:""}.fa-ellipsis-v:before{content:""}.fa-pencil-square:before{content:""}.fa-external-link-square:before{content:""}.fa-instagram:before{content:""}.fa-plus-square-o:before{content:""}.fa-envelope-square:before{content:""}.fa-google:before{content:""}.fa-cubes:before{content:""}.fa-header:before{content:""}amp-carousel{margin-bottom:.9375rem}h1 .fa,h2 .fa,h3 .fa,h4 .fa,h5 .fa,h6 .fa{margin-right:.2rem}code{color:#555}.hero-text{color:#666;padding-top:1.25rem;padding-bottom:.75rem}.social-icon i{font-size:1rem}.social-icon .fa-envelope{font-size:.875rem}.top-bar{padding:0 .9375rem}.top-bar .name{margin-top:18px;line-height:5.3125rem;height:3.125rem}.top-bar .name img{height:100%}.top-bar .social-icon{margin-left:.625rem}.top-bar .social-icon a{font-size:2rem}.top-bar .social-icon i{color:#fff;font-size:inherit}.top-bar .social-icon .fa-envelope{font-size:1.625rem}.top-bar .top-bar-section{overflow:hidden}.top-bar .top-bar-section .right{margin-top:-3px}.texture{background:url(/images/bg-1.gif)}.featured-heading,.heading{background:#ececec}.featured-heading h1,.featured-heading h2,.heading h1,.heading h2{margin:.5rem 0}.project-list-item .text-right h6,.project-list-item-roles .text-right .fa{margin-right:.9375rem}.featured{border-bottom:.5rem solid #ececec;padding-top:.9375rem;margin-bottom:1em}.project-list-item{border-bottom:1px solid #ececec}.project-list-item:last-child{border-bottom-width:0}.project-list-item h6{color:#999;padding-top:.9375rem}.project-list-item h6+h6{padding-top:.125rem}.project-list-item-roles .text-right{margin-top:-.2rem}.project-list-item-roles .text-right .fa-code{margin-right:1rem}.project-list-item-roles .text-right .fa-cubes{margin-right:.8125rem}.project-list-item-roles .text-right .fa-tag{color:#999}.project-list-item-roles li{font-size:.8rem}.project-summary p{margin-bottom:.25rem}.project-summary-detail>p:first-child:first-letter{font-size:1.6rem;line-height:1rem}.post-detail h2{font-size:1.125rem}.post-detail h3,.post-detail h4,.post-detail h5,.post-detail h6{font-size:1rem;color:#999}.inverse,.inverse h1,.inverse h2,.inverse h3,.inverse h4,.inverse h5,.inverse h6{color:#666}.post-detail h2 code,.post-detail h3 code,.post-detail h4 code,.post-detail h5 code,.post-detail h6 code{text-transform:none}.post-detail-tags{padding:1.125rem 0 .625rem}.inverse{background:#333}.inverse a:active,.inverse a:link,.inverse a:visited{color:#ccc}.inverse a:hover{color:#999}.inverse .name{margin:1.875rem 0;height:5rem}.inverse .name img{height:100%}footer{margin-top:1.875rem}.copyright a:active,.copyright a:hover,.copyright a:link,.copyright a:visited{color:#666}@media only screen and (min-width:40.0625em){.hero-text p{font-size:1.125rem}.project-list-item{border-bottom-width:0}.post-detail h2{font-size:1.375rem}.post-detail h3,.post-detail h4,.post-detail h5,.post-detail h6,.post-detail p{font-size:1.125rem}}</style>

</head>
<body>
    <div class="contain-to-grid">
    <nav class="top-bar" data-topbar role="navigation">
    <ul class="title-area">
        <li class="name">
            <a href="/"><amp-img width="61" height="50" src="/images/logo-masthead.png"></a>
        </li>
    </ul>

    <section class="top-bar-section">
        <div class="right">
            <span class="social-icon">
                <a href="mailto:contact@chrisbosco.com">
                    <i class="fa fa-envelope"></i>
                </a>
            </span>
            <span class="social-icon">
                <a href="https://github.com/cbosco" title="github">
                    <i class="fa fa-github"></i>
                </a>
            </span>
            <span class="social-icon">
                <a href="http://twitter.com/cbsides" title="Twitter">
                    <i class="fa fa-twitter"></i>
                </a>
            </span>
            <span class="social-icon">
                <a href="http://www.linkedin.com/in/chrisbosco" title="LinkedIn">
                    <i class="fa fa-linkedin-square"></i>
                </a>
            </span>
            <span class="social-icon">
                <a href="http://instagram.com/chrisbosco" title="Instagram">
                    <i class="fa fa-instagram"></i>
                </a>
            </span>
        </div>
    </section>

    </nav>
</div>

    <div class="row">
        <div class="small-12 columns">
        
            <nav class="breadcrumbs" role="menubar" aria-label="breadcrumbs">
                <a href="/posts.html">Blog Posts</a>
                <a class="unavailable" >
                    2013-6-4
                </a>
                <a class="current">Rails: Authenticate with EmberJS</a>
            </nav>
        
        </div>
    </div>
    <div class="heading text-center">
        <div class="row">
            <div class="small-12 columns">
                <h1>
                    Rails: Authenticate with EmberJS
                </h1>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="small-12 columns">
            <h6 class="text-center post-detail-tags">
                JavaScript, EmberJS, Ruby, Rails, Authentication
            </h6>
        </div>
    </div>


    <div class="row">
        <div class="small-12 columns">

    <div class="project-summary-detail post-detail">
        <h2 id="-get-the-ember-rails-gem-https-github-com-emberjs-ember-rails-"><a href="https://github.com/emberjs/ember-rails">Get the ember-rails gem</a></h2>
<p>This guide assumes Ember is <a href="https://github.com/emberjs/ember-rails#getting-started">bootstrapped and installed</a>.</p>
<h2 id="before-getting-started-with-authentication">Before getting started with authentication</h2>
<h3 id="a-required-environment-config-bug-">A required environment config (bug?)</h3>
<p>Before getting started with Ember, as of this writing, <a href="https://github.com/emberjs/ember-rails/issues/64">there is a bug</a> wherein specifying an Ember variant in your environment config is <strong>REQUIRED</strong>. So, be sure to manually include the appropriate variant.  </p>
<p>For example, in <code>config/environments/development.rb</code> add the line:</p>
<pre><code>config.ember.variant = :development
</code></pre><p>Rinse, repeat for <code>:production</code>, <code>:test</code>, etc.</p>
<h3 id="update-ember">Update Ember</h3>
<p>The version that came with my gem was a bit outdated so follow the guide to pull down the latest from master and check it into <code>/vendor</code>.</p>
<pre><code>rails generate ember:install --head
</code></pre><p>P.S. Restart your server after this. Don&#39;t make the same mistake I did.</p>
<h3 id="remove-ember-data-api-revision-from-the-store-">Remove Ember Data API revision from the <code>Store</code></h3>
<p><a href="http://emberjs.com/blog/2013/05/28/ember-data-0-13.html">As of 0.13 this became deprecated</a>.  This would be in <code>app/assets/javascripts/store.js.coffee</code>.</p>
<h3 id="log_transitions">LOG_TRANSITIONS</h3>
<p>Add a helpful transition logger in <code>application.js</code>:</p>
<pre><code>App = Ember.Application.create({
    LOG_TRANSITIONS: true
});
</code></pre><p><em>As of July there is an official Ember <a href="http://emberjs.com/guides/understanding-ember/debugging/">debugging guide</a>.</em></p>
<h2 id="onto-authentication-">Onto Authentication!</h2>
<p>With a brand new app, I recommend following the <a href="http://railscasts.com/episodes/250-authentication-from-scratch">Authentication From Scratch RailsCast</a> with bcrypt. (<a href="http://asciicasts.com/episodes/250-authentication-from-scratch">Transcript</a>)</p>
<p>After Ember is bootstrapped, the generators you run through the railscast tutorial should build corresponding JavaScript.</p>
<h3 id="intermission-">Intermission...</h3>
<p>Still there? Awesome.</p>
<h3 id="javascript-file-location-shorthand">JavaScript file location shorthand</h3>
<p>To clarify, any client-side work starts in the path <code>/app/assets/javascripts</code> and I will be omitting that for the most part.</p>
<h2 id="first-handlebars-templates">First Handlebars templates</h2>
<p>Create the <strong>application</strong> Handlebars template (<code>templates/application.hbs</code>). This is like the server-side <code>application.html.erb</code> template in <code>app/views/layouts</code>. Note the <code>{{outlet}}</code> -- this is where other templates appear. Similar to <code>&lt;%= yield %&gt;</code> in erb on the server.</p>
<p>templates/application.hbs</p>
<pre><code>&lt;h2&gt;Hello world&lt;/h2&gt;
&lt;div&gt;    
    {{outlet}}
&lt;/div&gt;
</code></pre><p>We can also create an <strong>index</strong> template while we are at it at, which can serve as our welcome page.</p>
<p>templates/index.hbs</p>
<pre><code>&lt;h1&gt;Welcome to my App!&lt;/h1&gt;
</code></pre><h2 id="creating-users">Creating users</h2>
<h3 id="create-the-model-first">Create the model first</h3>
<p>The <strong>User</strong> model is a little simpler than the server-side one. We just need <code>string</code> attributes for anything we need to submit to the server.</p>
<p>models/user.js.coffee</p>
<pre><code>App.User = DS.Model.extend
    email:  DS.attr(&#39;string&#39;)
    password:  DS.attr(&#39;string&#39;)
    passwordConfirmation:  DS.attr(&#39;string&#39;)
</code></pre><h3 id="followed-by-route-s-">Followed by route(s)</h3>
<p>To me, an Ember application&#39;s essence is its router.</p>
<p>Let&#39;s map Users as a resource with a <strong>new</strong> route:</p>
<p>router.js.coffee</p>
<pre><code>App.Router.map (match)-&gt;
    @resource(&#39;users&#39;, -&gt;
        @route(&#39;new&#39;)
    )
</code></pre><p>Unlike in Rails, you have to explicitly map the <strong>new</strong> route, even though you have used the <code>resource</code> method.</p>
<p>And now we can define the <strong>new</strong> route in its own file.</p>
<p>routes/users_new_route.js.coffee</p>
<pre><code>App.UsersNewRoute = Ember.Route.extend({
    model: -&gt;
        App.User.createRecord()
    events:
        save: -&gt;
            @content.save()
                .then =&gt;
                    @transitionToRoute(&#39;index&#39;)
        cancel: -&gt;
            @content.deleteRecord()
            @transitionToRoute(&#39;index&#39;)
})
</code></pre><p>Note first that <code>createRecord()</code> does not do any HTTP communication -- it is akin to <code>new</code> on a Rails ActiveRecord model and just sets up a resource in memory.</p>
<p>Since we are not yet deviating from the auto-generated Ember controller logic, there is no need to customize that layer yet. We can handle our events at the router level, as they mostly involve simple redirection anyway.</p>
<p>There are two events we plan to handle here: <strong>save</strong> and <strong>cancel</strong>.  </p>
<p>In the case of save, we call the <code>save()</code> method on the User model, which follows a promise API. When validation succeeds, you continue into the <code>then</code> case.</p>
<p>Cancel simply cleans up the User we created in memory when we first loaded this route.</p>
<h3 id="-and-template-s-">…and template(s)</h3>
<p>First off, once you have mapped this route you can link to it in your application template:</p>
<p>templates/application.hbs</p>
<pre><code>...
{{#linkTo users.new }}
    Sign Up
{{/linkTo}}
...
</code></pre><p>And now we add the new User form:</p>
<p>templates/users/new.hbs</p>
<pre><code>&lt;form {{action save on=&quot;submit&quot;}}&gt;
    &lt;div class=&quot;control-group&quot; {{bindAttr class=&quot;errors.email:error&quot;}}&gt;
        &lt;label for=&quot;user-email&quot;&gt;Email&lt;/label&gt;
        {{view Ember.TextField valueBinding=&quot;email&quot; id=&quot;user-email&quot; required=&quot;true&quot;}}
        &lt;span class=&quot;help-inline&quot;&gt;
            {{errors.email}}
        &lt;/span&gt;
    &lt;/div&gt;
    &lt;div class=&quot;control-group&quot; {{bindAttr class=&quot;errors.password:error&quot;}}&gt;
        &lt;label for=&quot;user-password&quot;&gt;Password&lt;/label&gt;
        {{view Ember.TextField valueBinding=&quot;password&quot; type=&quot;password&quot; id=&quot;user-password&quot; required=&quot;true&quot;}}
        &lt;span class=&quot;help-inline&quot;&gt;
            {{errors.password}}
        &lt;/span&gt;
    &lt;/div&gt;
    &lt;div class=&quot;control-group&quot; {{bindAttr class=&quot;errors.passwordConfirmation:error&quot;}}&gt;
        &lt;label for=&quot;user-password-confirmation&quot;&gt;Password confirmation&lt;/label&gt;
        {{view Ember.TextField valueBinding=&quot;passwordConfirmation&quot; type=&quot;password&quot; id=&quot;user-password-confirmation&quot; required=&quot;true&quot;}}
        &lt;span class=&quot;help-inline&quot;&gt;
            {{errors.passwordConfirmation}}
        &lt;/span&gt;
    &lt;/div&gt;
    &lt;button type=&quot;submit&quot;&gt;Join&lt;/button&gt;
    &lt;a {{action cancel}}&gt;Cancel&lt;/a&gt;
&lt;/form&gt;
</code></pre><p>What may seem complicated is basically a lot of markup giving us meaningful error states. The <strong>save</strong>  event (action) is bound to the form submission, and <strong>cancel</strong> is bound to an anchor tag.</p>
<h3 id="the-right-server-response">The right server response</h3>
<p>At this point you probably want to test this out, but we shuold make sure our Rails application responds in just the RESTful way Ember expects it to with its REST adapter. (That is, if you want to write the least code possible!)</p>
<p>There are two overarching rules here.</p>
<ol>
<li>When responding successfully with JSON data, always name your resource. In our case this means the User JSON should be within a key called <code>user</code> at the highest level in the parsed JSON tree. </li>
<li>When responding to an unsuccessful query with errors as JSON, name these <code>errors</code>!</li>
</ol>
<p>Finally, we can use a helpful Rails method called <code>respond_to</code> which forks our server response between HTML (traditional Rails site) and JSON (RESTful API communicating with Ember client).</p>
<p>Back to the Rails code, let&#39;s update the <code>users#create</code> action accordingly.</p>
<p>/app/controllers/user_controller.rb</p>
<pre><code>class UsersController &lt; ApplicationController

    ...

    def create
        @user = User.new params[:user]
        if @user.save
            respond_to do |format|
                format.html { redirect_to :root, notice: &quot;Signed up!&quot; }

                format.json { render json: { user: @user.as_json(only: :email) }, status: :created }
            end
        else
            respond_to do |format|
                format.html { render :new }
                format.json { render json: { errors: @user.errors }, status: :unprocessable_entity }
            end
        end
    end
end
</code></pre><p>By now you should be able to successfully create a new User.</p>
<h2 id="creating-sessions">Creating sessions</h2>
<h3 id="create-the-model-first">Create the model first</h3>
<p>For the model, follow the pattern for User.</p>
<p>The <strong>User</strong> model is a little simpler than the server-side one. We just need <code>string</code> attributes for anything we need to submit to the server.</p>
<p>models/session.js.coffee</p>
<pre><code>App.Session = DS.Model.extend
    email: DS.attr(&#39;string&#39;)
    password: DS.attr(&#39;string&#39;)    
</code></pre><h3 id="followed-by-route-s-">Followed by route(s)</h3>
<p>Let&#39;s map the sessions/new (log in) and sessions/destroy (log out)</p>
<p>router.js.coffee</p>
<pre><code>App.Router.map (match)-&gt;
    @resource(&#39;users&#39;, -&gt;
        @route(&#39;new&#39;)
    )
    @resource(&#39;sessions&#39;, -&gt;
        @route(&#39;new&#39;)
    )
</code></pre><p>We will handle two similar events once again: <strong>save</strong> and <strong>cancel</strong>.  </p>
<p>routes/sessions_new_route.js.coffee</p>
<pre><code>App.SessionsNewRoute = Ember.Route.extend(
    needs: [&#39;currentUser&#39;]

    model: -&gt;
        App.Session.createRecord()

    events:
        save: -&gt;
            @controller.content.save()
                .then =&gt;
                    @transitionTo(&#39;index&#39;)

        cancel: -&gt;
            @controller.content.deleteRecord()
            @transitionTo(&#39;index&#39;)
)
</code></pre><h3 id="-and-template-s-">…and template(s)</h3>
<p>Let&#39;s update the application template with a link to the Login form:</p>
<p>templates/application.hbs</p>
<pre><code>...
{{#linkTo users.new}}Sign Up{{/linkTo}} |
{{#linkTo sessions.new}}Login{{/linkTo}}
...
</code></pre><p>And now we add the the new Session (a.k.a. Login) form, similar to that for the user:</p>
<p>templates/sessions/new.hbs</p>
<pre><code>&lt;form {{action save on=&quot;submit&quot;}}&gt;
    &lt;div class=&quot;control-group&quot; {{bindAttr class=&quot;errors.email:error&quot;}}&gt;
        &lt;label for=&quot;user-email&quot;&gt;Email&lt;/label&gt;
        {{view Ember.TextField valueBinding=&#39;email&#39; id=&quot;user-email&quot; required=&quot;true&quot;}}
        &lt;span class=&quot;help-inline&quot;&gt;
            {{errors.email}}
        &lt;/span&gt;
    &lt;/div&gt;
    &lt;div class=&quot;control-group&quot; {{bindAttr class=&quot;errors.password:error&quot;}}&gt;
        &lt;label for=&quot;user-password&quot;&gt;Password&lt;/label&gt;
        {{view Ember.TextField type=&quot;password&quot; valueBinding=&#39;password&#39; id=&quot;user-password&quot; required=&quot;true&quot;}}
    &lt;/div&gt;
    &lt;button type=&quot;submit&quot;&gt;Login&lt;/button&gt;
    &lt;a {{action cancel}}&gt;Cancel&lt;/a&gt;
&lt;/form&gt;
</code></pre><h2 id="the-right-server-response-again-">The right server response (again)</h2>
<p>Before testing we need to update the way Sessions work on the Rails site. Although we don&#39;t have a model we need to update our controller and Sessions HTML form from the authentication example to work a little more like standard Rails resources.</p>
<p>Specifically, instead of passing discrete <code>:email</code> and <code>:password</code> params to log in, we should pass a <code>:session</code> params object as if we had posted from a <code>form_for</code> a Session resource. While we&#39;re at it, let&#39;s make sure these routes, like those in the User controller, respond with JSON.</p>
<p>Finally, the resource returned from session creation should actually be a User and not a Session, in order for us to have the notion of a currentUser in Ember (the final thing to implement). However, the User data is labeled as Session in the JSON to keep with the convention in the route. For example:</p>
<pre><code>{&quot;session&quot;:{&quot;email&quot;:&quot;me@example.com&quot;}}
</code></pre><p>/app/views/sessions/new.html.erb</p>
<pre><code>&lt;h1&gt;Sign in&lt;/h1&gt;
&lt;%= form_tag sessions_path do %&gt;
    &lt;p&gt;
        &lt;%= label_tag &#39;[session][email]&#39;, &#39;Email&#39; %&gt;
        &lt;%= text_field_tag &#39;[session][email]&#39;, (params[:session][:email] unless params[:session].nil?) %&gt;
    &lt;/p&gt;
    &lt;p&gt;
        &lt;%= label_tag &#39;[session][password]&#39;, &#39;Password&#39; %&gt;
        &lt;%= password_field_tag &#39;[session][password]&#39; %&gt;
    &lt;/p&gt;
    &lt;%= submit_tag %&gt;
&lt;% end %&gt;
</code></pre><p>/app/controllers/sessions_controller.rb</p>
<pre><code>def create
    user = User.authenticate params[:session]
    if user
        session[:user_id] = user.id

        respond_to do |format|
            format.html { redirect_to :root, notice: &quot;Logged in!&quot; }
            format.json { render json: { session: user.as_json(only: :email) }, status: :created }
        end
    else

        respond_to do |format|
            format.html {
                flash.now.alert = &quot;Invalid email or password&quot;
                render :new
            }
            format.json { render json: { errors: {email: &quot;Invalid email or password&quot;} }, status: :unprocessable_entity }
        end
    end
end
</code></pre><h2 id="current_user-how-about-currentuser">current_user? How about currentUser</h2>
<p>Let&#39;s follow a <a href="http://say26.com/using-rails-devise-with-ember-js">common pattern</a> of using a singleton controller for this.</p>
<p>controllers/current_user_controller.js.coffee</p>
<pre><code>App.CurrentUserController = Ember.ObjectController.extend(
    isSignedIn: (-&gt;
        @get(&#39;content&#39;) &amp;&amp; @get(&#39;content&#39;).get(&#39;isLoaded&#39;)
    ).property(&#39;content.isLoaded&#39;)
)
</code></pre><h3 id="an-initializer">An initializer</h3>
<p>We now want to prefill <code>currentUser</code> whenever the application initializes.</p>
<p>First, make sure initializers are in your manifest in your application&#39;s js file/manifest.</p>
<p>app.js</p>
<pre><code>#= require ./store
#= require_tree ./initializers
#= require_tree ./models
#= require_tree ./controllers
#= require_tree ./views
#= require_tree ./helpers
#= require_tree ./templates
#= require_tree ./routes
#= require ./router
#= require_self
</code></pre><p>Now write the initializer. This type of <a href="http://nerdyworm.com/blog/2013/04/03/ember-initializers/">initializer</a> pre-fetches some data before your app is completely initialized.</p>
<p>initializers/current_user.js.coffee</p>
<pre><code>Ember.Application.initializer(
    name: &#39;currentUser&#39;
    after: &#39;store&#39;

    initialize: (container) -&gt;
        store = container.lookup(&#39;store:main&#39;)
        user = App.User.find(&#39;current&#39;)
        container.lookup(&#39;controller:currentUser&#39;).set(&#39;content&#39;, user)
        container.typeInjection(&#39;controller&#39;, &#39;currentUser&#39;, &#39;controller:currentUser&#39;)
)
</code></pre><p>Note the <code>after: &#39;store&#39;</code> line to ensure the store is initialized before we operate on it. This is usually the case but it doesn&#39;t hurt to be 100% sure.</p>
<h3 id="route-update">Route update</h3>
<p>Let&#39;s update the <code>SessionsNewRoute</code> to set <code>currentUser</code> when successfully logging in.</p>
<p>routes/sessions_new_route.js.coffee</p>
<pre><code>App.SessionsNewRoute = Ember.Route.extend(
    needs: [&#39;currentUser&#39;]

    model: -&gt;
        App.Session.createRecord()

    events:
        save: -&gt;
            @controller.content.save()
                .then =&gt;
                    userJSON = @controller.content.toJSON()
                    userJSON.id = &#39;current&#39;
                    object = @store.load(App.User, userJSON)
                    user = App.User.find(&#39;current&#39;)

                    @controllerFor(&#39;currentUser&#39;).set(&#39;content&#39;, user)
                    @transitionTo(&#39;index&#39;)

        cancel: -&gt;
            @controller.content.deleteRecord()
            @transitionTo(&#39;index&#39;)
)
</code></pre><p>Note the new dependency on <code>currentUser</code> via the <code>needs</code> key.</p>
<pre><code>    needs: [&#39;currentUser&#39;]
</code></pre><h3 id="use-it-to-add-logic-to-your-sign-up-log-in-links">Use it to add logic to your sign up / log in links</h3>
<p>Now we can use our notion of the currently logged-in user to update the links in our navigation.</p>
<p>templates/application.hbs</p>
<pre><code>...
{{#if currentUser.isSignedIn}}
    Logged in as {{currentUser.email}}
{{else}}
    {{#linkTo users.new}}Sign Up{{/linkTo}} |
    {{#linkTo sessions.new}}Login{{/linkTo}}
{{/if}}
...
</code></pre><h3 id="the-right-server-response-final-pass-">The right server response (final pass)</h3>
<p>The initializer is going to make a request to the <code>users/current</code> path in your application. We can anticipate this by adding a CRUD route for the <code>show</code> action.</p>
<p>/config/routes.rb</p>
<pre><code>resources :users, only: [:new, :create, :show]
</code></pre><p>/app/controllers/users_controller.rb</p>
<pre><code>def show
    @user = current_user
    unless @user.nil?
        respond_to do |format|
            format.html
            format.json { render json: { user: @user.as_json(only: :email) } }
        end
    else
        respond_to do |format|
            format.html
            format.json { render json: { }, status: :accepted }
        end
    end
end
</code></pre><h2 id="ok-one-last-thing">Ok, one last thing</h2>
<p>We need a way to log out. Let&#39;s create a <code>sessions.destroy</code> route.</p>
<p>First, complete our router map.</p>
<p>router.js.coffee</p>
<pre><code>App.Router.map (match)-&gt;
    @resource(&#39;users&#39;, -&gt;
        @route(&#39;new&#39;)
    )
    @resource(&#39;sessions&#39;, -&gt;
        @route(&#39;new&#39;)
        @route(&#39;destroy&#39;)
    )
</code></pre><p>Now the route we create will run some code on the <code>enter</code> hook (as soon as it is entered). We unset <code>currentUser</code> and make a <code>GET</code> call to the server followed by a <code>DELETE</code> on the sessions resource to complete the logging out on the server.</p>
<p>routes/session_destroy_route.js.coffee</p>
<pre><code>App.SessionsDestroyRoute = Ember.Route.extend(
    enter: -&gt;
        controller = @controllerFor(&#39;currentUser&#39;);
        controller.set(&#39;content&#39;, undefined);

        App.Session.find(&#39;current&#39;)
            .then (session) -&gt;
                session.deleteRecord()
                controller.store.commit()

        @transitionTo(&#39;index&#39;)
)
</code></pre><h3 id="update-navigation-links">Update navigation links</h3>
<p>We can add a link to this new route in our <code>application.hbs</code> layout template.</p>
<p>templates/application.hbs</p>
<pre><code>...
{{#if currentUser.isSignedIn}}
    Logged in as {{currentUser.email}}
    ({{#linkTo sessions.destroy}}Logout{{/linkTo}})
{{else}}
    {{#linkTo users.new}}Sign Up{{/linkTo}} |
    {{#linkTo sessions.new}}Login{{/linkTo}}
{{/if}}
...
</code></pre><h3 id="one-last-update-to-the-rails-api">One last update to the Rails API</h3>
<p>In order to support the two server calls we should return <code>current_user</code> whenever <code>sessions/current</code> (or anything, for that matter) is requested, so we add this to the <code>show</code> action.</p>
<p>/app/controllers/sessions_controller.rb</p>
<pre><code>def show
    respond_to do |format|
        format.html
        format.json { render json: { session: current_user }, status: :accepted }
    end
end
</code></pre><p>Then to completely support the <code>DELETE</code> of the session, we need a familiar JSON response at the <code>destroy</code> action. No data is required; just a simple accepted response.</p>
<p>/app/controllers/sessions_controller.rb</p>
<pre><code>def destroy
    session[:user_id] = nil

    respond_to do |format|
        format.html { redirect_to :root, notice: &quot;Logged out!&quot; }
        format.json { render json: {}, status: :accepted }
    end
end
</code></pre><h2 id="you-re-done-">You&#39;re done!</h2>
<p>You should be able to create users, log them in and log them out all within the context of your single-page Ember application.</p>
<h2 id="a-working-example">A working example</h2>
<p>I have these steps put together in a <a href="https://github.com/cbosco/tickets-together/tree/just_authentication">working Rails app</a> that hopefully answers any remaining questions (Nothing like working code!)</p>
<h2 id="thanks">Thanks</h2>
<p>A great deal of this guide is adapted from <a href="http://pivotallabs.com/playing-with-ember-js-and-devise/">Playing with Ember.js and Devise</a> which walks through a similar set up on top of the <a href="https://github.com/plataformatec/devise">Devise</a> authentication gem. </p>

    </div>

        </div>

    </div>

            <footer class="inverse">

            <div class="row">
                <div class="small-12 columns">

        <p class="right">
            <a href="#">
                <i class="fa fa-angle-up"></i> top
            </a>
        </p>
        <div class="name">
            <a href="/"><amp-img width="98" height="80" src="/images/logo-footer.png"></a>
        </div>

<div class="place">
          <h2><a href="/posts.html">Blog</a></h2>
        </div>
        <div class="place">
        </div>

          <h2>Elsewhere</h2>
            <ul class="no-bullet">
              <li class="social-icon">
                  <a href="https://github.com/cbosco" title="github">
                    <i class="fa fa-github"></i>
                      cbosco
                  </a>
              </li>
              <li class="social-icon">
                  <a href="http://twitter.com/cbsides" title="Twitter">
                    <i class="fa fa-twitter"></i>
                  @cbsides
                  </a>
              </li>
              <li class="social-icon">
                  <a href="http://instagram.com/chrisbosco" title="Instagram">

                    <i class="fa fa-instagram"></i>
                      chrisbosco
                  </a>
              </li>

              <li class="social-icon">
                  <a href="http://www.linkedin.com/in/chrisbosco" title="LinkedIn">

                    <i class="fa fa-linkedin-square"></i>
                  Chris Bosco
                  </a>
              </li>

              <li class="social-icon">
                <a href="mailto:contact@chrisbosco.com">
                    <i class="fa fa-envelope"></i>
                  contact@chrisbosco.com
                  </a>
              </li>
            </ul>
          <p class="copyright">
            &copy; 2007-2016 <a href="mailto:contact@chrisbosco.com">Chris Bosco</a>
          </p>

                </div><!-- .row -->
            </div><!-- .small-12 columns -->
        </footer>

        <amp-analytics type="googleanalytics">
        <script type="application/json">
        {
          "vars": {
            "account": "UA-4850138-1"
          },
          "triggers": {
            "defaultPageview": {
              "on": "visible",
              "request": "pageview"
            }
          }
        }
        </script>
        </amp-analytics>


</body>
</html>

