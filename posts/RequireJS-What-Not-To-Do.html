<!DOCTYPE html>
<html lang="en" âš¡>
<head>
    <meta charset="utf-8">
<link rel="canonical" href="/posts/RequireJS-What-Not-To-Do.html">
<meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">

<style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>

<script async custom-element="amp-carousel" src="https://cdn.ampproject.org/v0/amp-carousel-0.1.js"></script>
<script async custom-element="amp-analytics" src="https://cdn.ampproject.org/v0/amp-analytics-0.1.js"></script>
<script async src="https://cdn.ampproject.org/v0.js"></script>


<title>RequireJS: What Not To Do</title>

<meta name="author" content="Chris Bosco">
<link rel="author" href="https://plus.google.com/107516626305634995395/posts"/>

  <meta name="keywords" content="chris bosco, chrisbosco, cbsides, cbosco, web, web app, designer, developer, portfolio, css, javascript, html, html5, user interface, ui, user experience, ux, experience design, interaction design">
  <meta name="copyright" content="copyright 2007-20014 chrisbosco.com">

<link href="https://fonts.googleapis.com/css?family=Oswald|Raleway" rel="stylesheet" type="text/css">
<link href="/assets/app.css" rel="stylesheet" type="text/css" media="all">

</head>
<body>
    <div class="contain-to-grid">
    <nav class="top-bar" data-topbar role="navigation">
    <ul class="title-area">
        <li class="name">
            <a href="/"><amp-img width="61" height="50" src="/images/logo-masthead.png"></a>
        </li>
    </ul>

    <section class="top-bar-section">
        <div class="right">
            <span class="social-icon">
                <a href="mailto:contact@chrisbosco.com">
                    <i class="fa fa-envelope"></i>
                </a>
            </span>
            <span class="social-icon">
                <a href="https://github.com/cbosco" title="github">
                    <i class="fa fa-github"></i>
                </a>
            </span>
            <span class="social-icon">
                <a href="http://twitter.com/cbsides" title="Twitter">
                    <i class="fa fa-twitter"></i>
                </a>
            </span>
            <span class="social-icon">
                <a href="http://www.linkedin.com/in/chrisbosco" title="LinkedIn">
                    <i class="fa fa-linkedin-square"></i>
                </a>
            </span>
            <span class="social-icon">
                <a href="http://instagram.com/chrisbosco" title="Instagram">
                    <i class="fa fa-instagram"></i>
                </a>
            </span>
        </div>
    </section>

    </nav>
</div>

    <div class="row">
        <div class="small-12 columns">
        
            <nav class="breadcrumbs" role="menubar" aria-label="breadcrumbs">
                <a href="/posts.html">Blog Posts</a>
                <a class="unavailable" >
                    2011-3-26
                </a>
                <a class="current">RequireJS: What Not To Do</a>
            </nav>
        
        </div>
    </div>
    <div class="heading text-center">
        <div class="row">
            <div class="small-12 columns">
                <h1>
                    RequireJS: What Not To Do
                </h1>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="small-12 columns">
            <h6 class="text-center post-detail-tags">
                JavaScript
            </h6>
        </div>
    </div>


    <div class="row">
        <div class="small-12 columns">

    <div class="project-summary-detail post-detail">
        <p>As with most things, using RequireJS wrong can be worse than not using
it at all.</p>
<p><a href="http://requirejs.org/">RequireJS</a> is a modular script loader that lets
you pull in multiple JavaScript files in an optimized way that cheats a
few rules we&#39;ve been used to when downloading resources in the
traditional way on the Web. Not only does RequireJS have great API
documentation, its <a href="http://requirejs.org/docs/why.html">Why</a> page is a
great read, and explains how they&#39;ve arrived at their approach of using
<code>head.appendChild(script)</code> to load JavaScript asynchronously.</p>
<p>After building <a href="http://chrisbosco.com/work/#/explore/the-shoshin-project">The Shoshin
Project</a> (a
simple single-page web app) which used <a href="http://code.google.com/closure/">Google
Closure</a> to bundle multiple JavaScript
files/modules into a single request, the concept evolved into a more
interactive, multiple-page site. As a team we decided to try out
RequireJS on the new site, hoping to carry on the modular approach used
in the original site without being forced to include all possible
combinations of JavaScript modules on every page load.</p>
<p>In our first dive into things, we put our page enhancements like
overlays, autocomplete, and so on into the RequireJS modular system.
Shortly into it we noticed some strange behavior where it looked like
some of our slower external scripts were blocking even the most simple
page interactions from livening up.</p>
<p>The (obvious in hindsight) breakthrough for me came in the realization
that externally hosted, third-party scripts can (and should) be loaded
using RequireJS. Traditionally, we did the most basic optimization of
putting our <code>script</code> tags near the end of the <code>body</code> tag so they don&#39;t
block page render, and then went the added step of putting any analytics
and/or externally hosted scripts below the application scripts so they
get parsed last and don&#39;t block page functionality.</p>
<p>What seems to have happened is RequireJS can&#39;t actually start executing
scripts until all synchronous script calls are done, as there could be
additional definitions it has yet to parse. So while we thought saving
our third party scripts for the end of the document was a good idea,
they were actually executing first, completely throwing a wrench into
things. Once it was clear that they can be easily incorporated into the
RequireJS dependency model, it was easy enough to create one-line
definitions for them and throw those at the end of our global RequireJS
definitions. No more blocking!</p>
<p>For example:</p>
<pre><code class="lang-javascript">define(<span class="string">'facebook'</span>, [<span class="string">'http://connect.facebook.net/en_US/all.js'</span>]);
</code></pre>
<p>The final solution, in terms of explicit script tags:</p>
<ol>
<li><a href="http://www.modernizr.com/">Modernizr</a> (in <code>head</code>)</li>
<li><a href="http://jquery.com/">jQuery</a> (via <a href="http://code.google.com/apis/libraries/devguide.html#jquery">Google
CDN</a>
with a <code>document.write()</code> <a href="http://html5boilerplate.com/">fallback to
local</a>)</li>
<li><a href="http://requirejs.org/">RequireJS</a></li>
<li>Global require definitions (via RequireJS)</li>
<li>Page specific require calls (via RequireJS)</li>
</ol>

    </div>

        </div>

    </div>

            <footer class="inverse">

            <div class="row">
                <div class="small-12 columns">

        <p class="right">
            <a href="#">
                <i class="fa fa-angle-up"></i> top
            </a>
        </p>
        <div class="name">
            <a href="/"><amp-img width="98" height="80" src="/images/logo-footer.png"></a>
        </div>

<div class="place">
          <h2><a href="/posts.html">Blog</a></h2>
        </div>
        <div class="place">
        </div>

          <h2>Elsewhere</h2>
            <ul class="no-bullet">
              <li class="social-icon">
                  <a href="https://github.com/cbosco" title="github">
                    <i class="fa fa-github"></i>
                      cbosco
                  </a>
              </li>
              <li class="social-icon">
                  <a href="http://twitter.com/cbsides" title="Twitter">
                    <i class="fa fa-twitter"></i>
                  @cbsides
                  </a>
              </li>
              <li class="social-icon">
                  <a href="http://instagram.com/chrisbosco" title="Instagram">

                    <i class="fa fa-instagram"></i>
                      chrisbosco
                  </a>
              </li>

              <li class="social-icon">
                  <a href="http://www.linkedin.com/in/chrisbosco" title="LinkedIn">

                    <i class="fa fa-linkedin-square"></i>
                  Chris Bosco
                  </a>
              </li>

              <li class="social-icon">
                <a href="mailto:contact@chrisbosco.com">
                    <i class="fa fa-envelope"></i>
                  contact@chrisbosco.com
                  </a>
              </li>
            </ul>
          <p class="copyright">
            &copy; 2007-2016 <a href="mailto:contact@chrisbosco.com">Chris Bosco</a>
          </p>

                </div><!-- .row -->
            </div><!-- .small-12 columns -->
        </footer>

        <amp-analytics type="googleanalytics">
        <script type="application/json">
        {
          "vars": {
            "account": "UA-4850138"
          },
          "triggers": {
            "defaultPageview": {
              "on": "visible",
              "request": "pageview"
            }
          }
        }
        </script>
        </amp-analytics>


</body>
</html>

